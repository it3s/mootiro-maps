function storageSet(e,t){window.sessionStorage.setItem(e,JSON.stringify(t))}function storageGet(e){return JSON.parse(window.sessionStorage.getItem(e))}function storageRemove(e){window.sessionStorage.removeItem(e)}function localStorageSet(e,t){window.localStorage.setItem(e,JSON.stringify(t))}function localStorageGet(e){return JSON.parse(window.localStorage.getItem(e))}function localStorageRemove(e){window.localStorage.removeItem(e)}function getCookie(e){var t=null;if(document.cookie&&document.cookie!==""){var n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=jQuery.trim(n[r]);if(i.substring(0,e.length+1)==e+"="){t=decodeURIComponent(i.substring(e.length+1));break}}}return t}function getUrlVars(){var e=[],t,n=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var r=0;r<n.length;r++)t=n[r].split("="),e.push(t[0]),e[t[0]]=t[1];return e}function geoObjectsSelection(e,t){var n=function(e,t){return st=Boolean($("input",$(e)).attr("checked")),t==undefined?st:(t!=st&&$("div.img-holder img",$(e)).trigger("click"),t)},r=$(e),i=[];r.on("click",function(e){$("div.img-holder img",$(this)).trigger("click"),t&&(n(r)===!1&&(i=s.filter(function(e){return n(this)})),$.each(i,function(e,t){$(t).click()}))}),$("div.img-holder, .collapser",r).on("click",function(e){return!1});if(t){var s=$(t),i=s;s.on("click",function(e){$("div.img-holder img",$(this)).trigger("click");var t=s.filter(function(e){return n(this)}).length;t===0?n(r,!1):n(r,!0)}),$("div.img-holder, .collapser",s).on("click",function(e){return!1})}}function geoObjectsListing(e){var t=$(e);$(".collapser",t).on("click",function(e){if(t.hasClass("frozen"))return!1;var n=$(this);$("i",n).toggleClass("icon-chevron-right icon-chevron-down"),n.parent().next().toggle()}),geoObjectsSelection($("li.communities",t)),geoObjectsSelection($("li.needs",t),$("li.need.sublist ul li",t)),geoObjectsSelection($("li.organizations",t)),geoObjectsSelection($("li.resources",t))}function _displayMessage(e,t,n,r,i,s){s||(s=[{text:"Ok","class":"button",click:function(){$(this).dialog("close")}}]);var o=e;return $(".message",o).text(r),o.dialog({dialogClass:t,title:n,modal:!0,buttons:s,resizable:!1,draggable:!1,width:400}),o}function errorMessage(e,t,n,r){return _displayMessage($("#error-box"),"error-dialog",e,t,n,r)}function infoMessage(e,t,n,r){return _displayMessage($("#info-box"),"info-dialog",e,t,n,r)}function confirmationMessage(e,t,n,r){return buttons=[{text:gettext("Yes"),"class":"btn",click:function(){r("yes"),$(this).dialog("close")}},{text:gettext("No"),"class":"button",click:function(){r("no"),$(this).dialog("close")}}],infoMessage(e,t,n,buttons)}function unexpectedError(e){title="Ops!",message="O Spock comeu um pedaço do código... Nos escreva falando que problema você encontrou para que possamos resolvê-lo!",buttons=[];var t=$("#unexpected-error-box");return $(".message",t).text(message),$("input[name=url]").val(location.href),$("input[name=info]").val(e||""),t.dialog({dialogClass:"error-dialog unexpected-error-dialog",title:title,modal:!0,buttons:buttons,resizable:!1,draggable:!1,width:650}),t}function flash(e,t){var n=t||1e4,r=$("#flash-message");$(".message",r).text(e),r.show(),n>0&&setTimeout(function(){r.fadeOut()},n)}function nestCollection(e,t,n){for(var r=0;r<n.length;r++)e.attributes[t][r]=n.at(r).attributes;return n.bind("add",function(n){e.get(t)||(e.attributes[t]=[]),e.get(t).push(n.attributes)}),n.bind("remove",function(n){var r={};r[t]=_.without(e.get(t),n.attributes),e.set(r)}),n}jQuery(document).ajaxSend(function(e,t,n){function r(e){var t=document.location.host,n=document.location.protocol,r="//"+t,i=n+r;return e==i||e.slice(0,i.length+1)==i+"/"||e==r||e.slice(0,r.length+1)==r+"/"||!/^(\/\/|http:|https:).*/.test(e)}function i(e){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(e)}!i(n.type)&&r(n.url)&&t.setRequestHeader("X-CSRFToken",getCookie("csrftoken"))}),Tabs=function(e,t,n,r){this.tabs=e,this.contents=t,this.selectedClass=r||"selected",this.onChange=n||function(e){},$(t).hide();var i=this;$(e).click(function(){return i.to(this),!1}),this.length=$(e).length,this.to($(e)[0]),this.initialized=!0},Tabs.prototype.to=function(e){$(this.tabs).removeClass(this.selectedClass),$(this.contents).removeClass(this.selectedClass).hide();var t=$(e).attr("href")||$(e).children().attr("href");$("*[href="+t+"]").parent().addClass(this.selectedClass),$(t).addClass(this.selectedClass).show(),this.current=e,this.onChange&&this.initialized&&this.onChange(this)},Tabs.prototype.getCurrentTabIndex=function(){return $(this.tabs).index(this.current)},function(e){e.fn.clearForm=function(){return this.each(function(){var t=this.type,n=this.tagName.toLowerCase();if(n=="form")return e(":input",this).clearForm();t=="text"||t=="password"||n=="textarea"?jQuery(this).val(""):t=="hidden"&&this.name!=="csrfmiddlewaretoken"?jQuery(this).val(""):t=="checkbox"||t=="radio"?jQuery(this).attr("checked",!1):n=="select"&&jQuery(this).val("")})}}(jQuery),function(e){e.fn.komooFormHintBoxes=function(t){var n={left:"740px",top:"-2px"},r=e(this),i=function(t){var t=e(t),n,r;for(n=t,r=0;!e(n).is(".control-group")&&r<15;n=n.parent(),r++);e(".control-group.focus").each(function(n,r){var r=e(r);r.is(t)||(r.removeClass("focus"),r.find(".field-hint-box-wrapper").hide())}),n.is(".control-group")&&!n.is(".focus")&&(n.addClass("focus"),n.find(".field-hint-box-wrapper").show())};e(function(){e(".field-hint-box-wrapper").hide()}),e("input, textarea").live("focus",function(){i(this)}),e("#div_id_files, #div_id_logo, .org-widget-categories, #div_id_categories").live("click",function(){i(this)}),e.each(t,function(t,i){var s=r.find("#div_id_"+t);s.find(".controls").append("<div class='field-hint-box-wrapper'><span class='hint-box-line'>&nbsp;&nbsp;</span><div class='field-hint-box'><img class='hint-icon' src='/static/img/hint-icon.png' ><div class='hint-text'>"+i.hint+"</div>"+"</div>"+"</div>");var o={};e.extend(o,n,i),s.find(".field-hint-box-wrapper").css("left",o.left).css("top",o.top),o.width&&(s.find(".field-hint-box-wrapper").css("width",o.width+30),s.find(".field-hint-box").css("width",o.width))}),e(".close").click(function(){e(this).parent().fadeOut()})}}(jQuery),require(["jquery","jquery-ui"],function(e){e("a.login-required").bind("click.loginrequierd",function(t){if(KomooNS&&!KomooNS.isAuthenticated){t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault();var n=e(this).attr("href");return n.charAt(0)=="#"&&(n=document.location.pathname+n),e("#login_box #login-button").attr("href","/user/login?next="+encodeURIComponent(n)),e("#login_box").dialog({width:600,modal:!0,resizable:!1,draggable:!1}),!1}})}),function(e){e.fn.komooTooltip=function(){var t=e(this);t.tooltip({placement:"bottom",trigger:"manual"}).on("click",function(n){t=e(n.target),t.tooltip("show"),e(".tooltip").on("mouseleave",function(e){t.tooltip("hide")})})}}(jQuery)