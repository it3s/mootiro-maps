{% load i18n %}
{% load komoo_tags %}

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>


    <title>{% block title %}Mootiro Maps{% endblock %}</title>

    <!-- Facebook sharing tags -->
    {#<meta property="og:title" content="title" />#}
    <meta property="og:description" content="MootiroMaps é uma ferramenta open source que promove a colaboração entre atores engajados no desenvolvimento de um território ou uma comunidade."/>
    <meta property="og:image" content="{{STATIC_URL}}img/logo.png"/>

    {{ form.media.css }}
    <link rel="shortcut icon" HREF="{{STATIC_URL}}/img/favicon.png" />
    <link rel="stylesheet" type="text/css" href="{{STATIC_URL}}css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="{{STATIC_URL}}lib/jquery-ui-1.8.16/jquery-ui-1.8.16.css" />

    <link rel="stylesheet" type="text/css" href="{{STATIC_URL}}css/styles.css" />
    <link rel="stylesheet" type="text/css" href="{{STATIC_URL}}css/fashion.css" />

    <!-- Django utilities -->
    <script type="text/javascript" src="{% url javascript_catalog %}"></script>
    <script type="text/javascript" src="{{STATIC_URL}}lib/django-js-utils/dutils.js"></script>
    <script type="text/javascript" src="{{STATIC_URL}}lib/django-js-utils/dutils.conf.urls.js"></script>

    <script type="text/javascript">
      var KomooNS = (function (KomooNS) {
        KomooNS.isAuthenticated = {{ user.is_authenticated|lower }};
        KomooNS.lang = '{{ LANGUAGE_CODE }}';
        KomooNS.facebookAppId = '{{ FACEBOOK_APP_ID }}';
        {% if not debug %}
        // Loads optimized scripts
        KomooNS.require_baseUrl = '{{STATIC_URL}}js.build';
        {% else %}
        KomooNS.require_baseUrl = '{{STATIC_URL}}js';
        {% endif %}

        {% if object %}
        KomooNS.object = {{ object.json|safe|default:'{}' }};
        {% endif %}

        return KomooNS;
      }(KomooNS || {}));

      {% if csrf_token %}
      window.csrf_token = '{{ csrf_token }}';
      {% endif %}

    </script>

    <!-- Main libs -->
    <script type="text/javascript" src="{{STATIC_URL}}lib/jquery-1.7.1.min.js"></script>
    <script type="text/javascript" src="{{STATIC_URL}}lib/jquery-ui-1.8.16/jquery-ui-1.8.16.min.js"></script>
    <script type="text/javascript" src="{{STATIC_URL}}lib/bootstrap.min.js"></script>

    <script type="text/javascript" src="http://www.google.com/jsapi"></script>


    {{ form.media.js }}
    {% block css %}{% endblock %}

  </head>
  <body class="{% if community %}community{% endif %}">
    {# Loading these scripts inside body to prevent issues loading google maps #}
    <!-- RequireJS stuffs -->
    <script type="text/javascript" src="{{STATIC_URL}}js/config.js"></script>
    <script type="text/javascript" data-main="app" src="{{STATIC_URL}}lib/require.js"></script>
    <script type="text/javascript" src="{{STATIC_URL}}js/utils.js"></script>


    {% include 'main/upper_bar.html' %}

    <div id="flash-message"><span class="message"></span></div>

    <div id="root">
      <div id="top">
        <div id="logo">
          <a href="{% url root %}"><img src='{{STATIC_URL}}img/logo.png' alt='Mootiro Maps'/></a>
        </div>
        <div id="navigation">

          <form id="search" action=".">
            <input type="text" id="search-bar"/>
            <input type="submit" id="search-button" class="button" value="{% trans 'See Results' %}"/>
            <div id="search-canvasloader-container" class="inline-block"></div>
          </form>
          <div id="search-results-box"></div>

          {% block menu %}
              {% menu "" %}
          {% endblock %}

        </div>

      </div>
      <div id="content">
        {% block content %}{% endblock %}
      </div>
      <div id="footer">
        {% block footer %}
          {% include "main/footer.html" %}
        {% endblock %}
      </div>
      {% if not user.is_authenticated %}
        {% include "authentication/login_box.html" %}
      {% endif %}
      {% include "main/error_box.html" %}
    </div>
    {% block page_scripts %}{% endblock %}

    {% if js_module %}
    <script type="text/javascript">
      // Loads the page specific module
      require(['common'], function (common) {
        require(['{{ js_module }}']);
      });
    </script>
    {% endif %}
  </body>
</html>
